@model IEnumerable<prjDB_GamingForm_Show.Models.Entities.Depute>

@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@

@Html.ActionLink("發佈委託","Create","Depute",null,new{@class="btn btn-primary tm-btn-next"})
@Html.ActionLink("TEST我要應徵","Apply","Depute",null,new{@class="btn btn-primary tm-btn-next"})
<table class="table table-striped table-bordered">

    <tr>
        <th class="col-1">
            #
        </th>
        <th class="col-1">
            標題
        </th>
        <th class="col-2">
            內容
        </th>
        <th class="col-1">
            地區
        </th>
        <th class="col-1">
            狀態
        </th>
        <th class="col-1">
            報酬
        </th>
        <th class="col-1">
            更新日期
        </th>
        <th class="col-1">
            發佈日期
        </th>
        <th class="col-1">
            應徵人數
        </th>
        <th class="col-2"></th>
    </tr>


    @{
        int count = 0;
        foreach (var i in Model)
        {
            count++;
            <tr>
                <td class="col-1">
                    @count
                </td>
                <td class="col-1">
                    @i.Title
                </td>
                <td class="col-3">
                    @i.DeputeContent
                </td>
                <td class="col-1">
                    @i.Region.City
                </td>
                <td class="col-1">
                    @i.Status.Name
                </td>
                <td class="col-1">
                    @i.Salary.ToString("$###,###,###.00")
                </td>
                <td class="col-1">
                    @i.Modifiedate.ToString("yyyy/mm/dd")
                </td>
                <td class="col-1">
                    @i.StartDate.ToString("yyyy/mm/dd")
                </td>
                <td class="col-1">
                    @i.DeputeRecords.Count()
                </td>
                <td class="col-2">
                    @Html.ActionLink("修改", "Edit", "Depute", new { id = i.DeputeId }, new { @class = "btn btn-success" })
                    <button class="btn btn-info btn-ReleaseDeputeDetails" onclick="detailsDepute(@i.DeputeId)">詳細資料</button>
                    <button class="btn btn-danger btn-ReleaseDeputeDelete" data_deputeid=@i.DeputeId>刪除</button>
                </td>
            </tr>
        }
    }
</table>

<script>

    async function detailsDepute(deputeID) {
        const response = await fetch(`@Url.Content("~/depute/DeputeDetial")?id=${deputeID}`);
        const data = await response.json();
        console.log(data);

        Swal.fire({
            title: "詳細資料",
            html: `  <ul class="list-group list-group-numbered ">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div class="ms-2 me-auto"  >
                            <div class="fw-bold" style="text-align:left;color:black">標題</div>
                            <div style="text-align:left;color:black">${data.title}</div>
                  </div>
                </li>
                    <li class="list-group-item d-flex justify-content-between align-items-start">
                      <div class="ms-2 me-auto" style="color:black">
                                <div class="fw-bold" style="text-align:left;color:black">內容</div>
                                        <div style="text-align:left;color:black">${data.deputeContent}</div></div>
                      </div>
                    </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div class="ms-2 me-auto" style="color:black">
                            <div class="fw-bold" style="text-align:left;color:black">地區</div>
                            <div style="text-align:left;color:black">${data.region}</div>
                  </div>
                </li>
                    <li class="list-group-item d-flex justify-content-between align-items-start">
                      <div class="ms-2 me-auto" style="color:black">
                                <div class="fw-bold" style="text-align:left;color:black">狀態</div>
                                    <div style="text-align:left;color:black">${data.status}</div>
                      </div>
                    </li>
                        <li class="list-group-item d-flex justify-content-between align-items-start">
                          <div class="ms-2 me-auto" style="color:black">
                                    <div class="fw-bold" style="text-align:left;color:black">應徵人數</div>
                                            <div style="text-align:left;color:black">${data.count}</div>
                          </div>
                        </li>
                            <li class="list-group-item d-flex justify-content-between align-items-start">
                              <div class="ms-2 me-auto" style="color:black">
                                        <div class="fw-bold" style="text-align:left;color:black">報酬</div>
                                                    <div style="text-align:left;color:black">${data.salary}</div>
                              </div>
                            </li>
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                  <div class="ms-2 me-auto" style="color:black">
                                            <div class="fw-bold" style="text-align:left;color:black">雇主姓名</div>
                                                            <div style="text-align:left;color:black">${data.providername}</div>
                                  </div>
                                </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-start">
                                      <div class="ms-2 me-auto" style="color:black">
                                                <div class="fw-bold" style="text-align:left;color:black">開始日期</div>
                                                                    <div style="text-align:left;color:black">${data.startdate}</div>
                                      </div>
                                    </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-start">
                                          <div class="ms-2 me-auto" style="color:black">
                                                    <div class="fw-bold" style="text-align:left;color:black">更新日期</div>
                                                                            <div style="text-align:left;color:black">${data.modifieddate}</div>
                                          </div>
                                        </li>
              </ul>`
        });

    }
    function deleteDepute() {

    }
</script>